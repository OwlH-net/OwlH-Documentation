

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Traffic Quality &mdash; owlh 0.17.x documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="owlh 0.17.x documentation" href="../../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> owlh
          

          
          </a>

          
            
            
              <div class="version">
                0.17.x
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../OwlHGS.html">Getting Started with OwlH</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../components.html">Components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components.html#owlh-master">OwlH Master</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components.html#owlh-node">OwlH Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components.html#owlh-ui">OwlH UI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components.html#owlh-client">OwlH Client</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../capabilities.html">Capabilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../capabilities.html#nids-and-traffic-analysis-support">NIDS and Traffic analysis support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../capabilities.html#top-capabilities">Top capabilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../capabilities.html#traffic-transport-and-management">Traffic transport and management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../capabilities.html#owlh-plugins">OwlH Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../capabilities.html#others">Others</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html">Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#standard-data-flow">Standard data flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#inside-owlh-node">Inside OwlH Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#used-ports">Used ports</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../OwlHInstall.html">Install OwlH</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../OwlHInstall.html#owlh-installer">OwlH Installer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../OwlHInstall.html#install-components">Install components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../OwlHInstall.html#standard-installation">Standard Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../OwlHInstall.html#advanced-installation">Advanced Installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../OwlHInstall.html#configure">Configure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../OwlHInstall.html#visualization">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../OwlHInstall.html#appendices">Appendices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../OwlHUpdate.html">Update and upgrade OwlH</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../OwlHUpdate.html#owlh-components">OwlH components</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../OwlHUM.html">User Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../OwlHFC.html">First configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../OwlHFC.html#user-interface">User Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../OwlHFC.html#analyzer">Analyzer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../OwlHFC.html#suricata">Suricata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../OwlHFC.html#zeek">Zeek</a></li>
<li class="toctree-l3"><a class="reference internal" href="../OwlHFC.html#wazuh">Wazuh</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../OwlHCF.html">Configuration Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../OwlHapiconf.html">API service configuration files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../OwlHapiconf.html#node-configuration">Node configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../OwlHapiconf.html#master-configuration">Master configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../OwlHmainconf.html">Main Configuration files (main.conf)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../OwlHMasterMainConf.html">Master Main Configuration file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../OwlHNodeMainConf.html">Node Main Configuration file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../OwlHAnalyzer.html">Analyzer configuration file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../OwlHAPI.html">OwlH API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../OwlHAPIM.html">OwlH MASTER RESTful API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../OwlHAPIN.html">OwlH NODE RESTful API</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../OwlHTroubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../OwlHTroubleshooting.html#owlh-node">OwlH Node</a></li>
<li class="toctree-l2"><a class="reference internal" href="../OwlHTroubleshooting.html#owlh-master">OwlH Master</a></li>
<li class="toctree-l2"><a class="reference internal" href="../OwlHTroubleshooting.html#owlh-ui">OwlH UI</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lookingfor.html">Looking forâ€¦</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../OwlHSuricata.html">OwlH and Suricata</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../OwlHSuricata.html#main-steps">Main steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../OwlHSuricata.html#suricata-output-with-owlh">Suricata output with OwlH</a></li>
<li class="toctree-l3"><a class="reference internal" href="../OwlHSuricata.html#suricata-rules">Suricata Rules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../OwlHZeek.html">OwlH and Zeek</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../OwlHZeek.html#integration-logical-diagram">Integration Logical Diagram</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../OwlHZeek.html#components">Components</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../OwlHZeek.html#configure-zeek-owlh-node">Configure - Zeek - OwlH Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="../OwlHZeek.html#zeek-logs-output-format-to-json">Zeek Logs Output format to JSON</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../OwlHZeek.html#option-1-modify-ascii-writer-output">Option 1 - Modify ASCII writer output</a></li>
<li class="toctree-l4"><a class="reference internal" href="../OwlHZeek.html#zeek-event-enritchment-to-help-wazuh-ruleset">Zeek Event Enritchment to help Wazuh ruleset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../OwlHZeek.html#loading-zeek-customizations-at-zeek-start">Loading Zeek customizations at Zeek start</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../OwlHZeek.html#review-your-kibana-dashboard">Review your Kibana Dashboard</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../OwlHMoloch.html">OwlH and Moloch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../OwlHMoloch.html#configure-moloch">Configure Moloch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../OwlHMoloch.html#moloch-in-master">Moloch in Master</a></li>
<li class="toctree-l3"><a class="reference internal" href="../OwlHMoloch.html#moloch-in-remote-server">Moloch in remote server</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../scenarios.html">Use Cases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../scenarios.html#basic">BASIC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scenarios.html#advanced">ADVANCED</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scenarios.html#integrate-with-wazuh">INTEGRATE WITH WAZUH</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">If you need help</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">owlh</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Traffic Quality</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/main/TS/trafficqa.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="traffic-quality">
<h1>Traffic Quality<a class="headerlink" href="#traffic-quality" title="Permalink to this headline">Â¶</a></h1>
<p>Check your traffic to verify it is good enough. If there is no good traffic you wonâ€™t see alerts as expected.</p>
<div class="section" id="is-there-any-traffic">
<h2>Is there any traffic?<a class="headerlink" href="#is-there-any-traffic" title="Permalink to this headline">Â¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># tcpdump -i ens192 -nn</span>
</pre></div>
</div>
<p>output should be verbose.</p>
<ul class="simple">
<li>Can I see traffic that is not brocast or related to my interface?</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># tcpdump -i ens192 -nn not arp and not net 224.0.0.0/8</span>
</pre></div>
</div>
<p>output should be verbose.</p>
<ul class="simple">
<li>Try to filter out not relevant traffic, run previous command, find one or two ports that are no relevant and filter them</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># tcpdump -i ens192 -nn not arp and not net 224.0.0.0/8 and not port 22 and not port 443</span>
</pre></div>
</div>
<p>Your output should show traffic in relevant ports. keep filtering adding <code class="docutils literal"><span class="pre">and</span> <span class="pre">not</span> <span class="pre">port</span> <span class="pre">xxx</span></code> as needed</p>
<ul class="simple">
<li>Can I see local traffic only?</li>
</ul>
<p>Check if your interface can see remote traffic. This is supposing internal network is 172.16.0.0/16 and 10.0.0.0/8</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># tcpdump -i ens192 -nn not dst net 172.16.0.0/16</span>
<span class="c1"># tcpdump -i ens192 -nn not dst net 172.16.0.0/16 and not dst net 10.0.0.0/8</span>
</pre></div>
</div>
<p>you should see traffic with destination ips outside your network</p>
<ul class="simple">
<li>bandwith, packet size, and other traffic statistics</li>
</ul>
<p>Use a tool like iptraf-ng to review deteails about your traffic</p>
<div class="highlight-default"><div class="highlight"><pre><span></span># iptraf-ng -d eth0

 iptraf-ng 1.1.4
  â”Œ Statistics for eth0 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”‚               Total      Total    Incoming   Incoming    Outgoing   Outgoing
  â”‚             Packets      Bytes     Packets      Bytes     Packets      Bytes
  â”‚ Total:          200      33240         105       5532          95      27708
  â”‚ IPv4:           200      33240         105       5532          95      27708
  â”‚ IPv6:             0          0           0          0           0          0
  â”‚ TCP:            200      33240         105       5532          95      27708
  â”‚ UDP:              0          0           0          0           0          0
  â”‚ ICMP:             0          0           0          0           0          0
  â”‚ Other IP:         0          0           0          0           0          0
  â”‚ Non-IP:           0          0           0          0           0          0
  â”‚                                    â”‚
  â”‚ Total rates:         36.46 kbps            Broadcast packets:            0
  â”‚                         25 pps             Broadcast bytes:              0
  â”‚
  â”‚ Incoming rates:       5.45 kbps
  â”‚                         12 pps
  â”‚                                            IP checksum errors:           0
  â”‚ Outgoing rates:      31.00 kbps
  â”‚                         12 pps
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, owlh team.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.17.x',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>