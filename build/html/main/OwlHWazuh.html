

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Integration with Wazuh-ELK &mdash; owlh 0.17.x documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="owlh 0.17.x documentation" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> owlh
          

          
          </a>

          
            
            
              <div class="version">
                0.17.x
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="OwlHGS.html">Getting Started with OwlH</a><ul>
<li class="toctree-l2"><a class="reference internal" href="components.html">Components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="components.html#owlh-master">OwlH Master</a></li>
<li class="toctree-l3"><a class="reference internal" href="components.html#owlh-node">OwlH Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="components.html#owlh-ui">OwlH UI</a></li>
<li class="toctree-l3"><a class="reference internal" href="components.html#owlh-client">OwlH Client</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="capabilities.html">Capabilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="capabilities.html#nids-and-traffic-analysis-support">NIDS and Traffic analysis support</a></li>
<li class="toctree-l3"><a class="reference internal" href="capabilities.html#top-capabilities">Top capabilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="capabilities.html#traffic-transport-and-management">Traffic transport and management</a></li>
<li class="toctree-l3"><a class="reference internal" href="capabilities.html#owlh-plugins">OwlH Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="capabilities.html#others">Others</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#standard-data-flow">Standard data flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#inside-owlh-node">Inside OwlH Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="architecture.html#used-ports">Used ports</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="OwlHInstall.html">Install OwlH</a><ul>
<li class="toctree-l2"><a class="reference internal" href="OwlHInstall.html#owlh-installer">OwlH Installer</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHInstall.html#install-components">Install components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="OwlHInstall.html#standard-installation">Standard Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="OwlHInstall.html#advanced-installation">Advanced Installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="OwlHInstall.html#configure">Configure</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHInstall.html#visualization">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHInstall.html#appendices">Appendices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="OwlHUpdate.html">Update and upgrade OwlH</a><ul>
<li class="toctree-l2"><a class="reference internal" href="OwlHUpdate.html#owlh-components">OwlH components</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="OwlHUM.html">User Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="OwlHFC.html">First configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="OwlHFC.html#user-interface">User Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="OwlHFC.html#analyzer">Analyzer</a></li>
<li class="toctree-l3"><a class="reference internal" href="OwlHFC.html#suricata">Suricata</a></li>
<li class="toctree-l3"><a class="reference internal" href="OwlHFC.html#zeek">Zeek</a></li>
<li class="toctree-l3"><a class="reference internal" href="OwlHFC.html#wazuh">Wazuh</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="OwlHCF.html">Configuration Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="OwlHapiconf.html">API service configuration files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="OwlHapiconf.html#node-configuration">Node configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="OwlHapiconf.html#master-configuration">Master configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="OwlHmainconf.html">Main Configuration files (main.conf)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="OwlHMasterMainConf.html">Master Main Configuration file</a></li>
<li class="toctree-l4"><a class="reference internal" href="OwlHNodeMainConf.html">Node Main Configuration file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="OwlHAnalyzer.html">Analyzer configuration file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="OwlHAPI.html">OwlH API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="OwlHAPIM.html">OwlH MASTER RESTful API</a></li>
<li class="toctree-l3"><a class="reference internal" href="OwlHAPIN.html">OwlH NODE RESTful API</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="OwlHTroubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="OwlHTroubleshooting.html#owlh-node">OwlH Node</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHTroubleshooting.html#owlh-master">OwlH Master</a></li>
<li class="toctree-l2"><a class="reference internal" href="OwlHTroubleshooting.html#owlh-ui">OwlH UI</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lookingfor.html">Looking forâ€¦</a><ul>
<li class="toctree-l2"><a class="reference internal" href="OwlHSuricata.html">OwlH and Suricata</a><ul>
<li class="toctree-l3"><a class="reference internal" href="OwlHSuricata.html#main-steps">Main steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="OwlHSuricata.html#suricata-output-with-owlh">Suricata output with OwlH</a></li>
<li class="toctree-l3"><a class="reference internal" href="OwlHSuricata.html#suricata-rules">Suricata Rules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="OwlHZeek.html">OwlH and Zeek</a><ul>
<li class="toctree-l3"><a class="reference internal" href="OwlHZeek.html#integration-logical-diagram">Integration Logical Diagram</a><ul>
<li class="toctree-l4"><a class="reference internal" href="OwlHZeek.html#components">Components</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="OwlHZeek.html#configure-zeek-owlh-node">Configure - Zeek - OwlH Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="OwlHZeek.html#zeek-logs-output-format-to-json">Zeek Logs Output format to JSON</a><ul>
<li class="toctree-l4"><a class="reference internal" href="OwlHZeek.html#option-1-modify-ascii-writer-output">Option 1 - Modify ASCII writer output</a></li>
<li class="toctree-l4"><a class="reference internal" href="OwlHZeek.html#zeek-event-enritchment-to-help-wazuh-ruleset">Zeek Event Enritchment to help Wazuh ruleset</a></li>
<li class="toctree-l4"><a class="reference internal" href="OwlHZeek.html#loading-zeek-customizations-at-zeek-start">Loading Zeek customizations at Zeek start</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="OwlHZeek.html#review-your-kibana-dashboard">Review your Kibana Dashboard</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="OwlHMoloch.html">OwlH and Moloch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="OwlHMoloch.html#configure-moloch">Configure Moloch</a></li>
<li class="toctree-l3"><a class="reference internal" href="OwlHMoloch.html#moloch-in-master">Moloch in Master</a></li>
<li class="toctree-l3"><a class="reference internal" href="OwlHMoloch.html#moloch-in-remote-server">Moloch in remote server</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scenarios.html">Use Cases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="scenarios.html#basic">BASIC</a></li>
<li class="toctree-l2"><a class="reference internal" href="scenarios.html#advanced">ADVANCED</a></li>
<li class="toctree-l2"><a class="reference internal" href="scenarios.html#integrate-with-wazuh">INTEGRATE WITH WAZUH</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contact.html">If you need help</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">owlh</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Integration with Wazuh-ELK</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/main/OwlHWazuh.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="integration-with-wazuh-elk">
<h1>Integration with Wazuh-ELK<a class="headerlink" href="#integration-with-wazuh-elk" title="Permalink to this headline">Â¶</a></h1>
<p>if you want to send OwlH output including Suricata and Zeek alerts and logs to Wazuh-ELK</p>
<p>This will help to integrate your NIDS alerts and output into Wazuh world. this is a one-way integration process.</p>
<p>As usual, please keep in contact if there is any clarification or help needed.</p>
<ul class="simple">
<li>email our support team - <a class="reference external" href="mailto:support&#37;&#52;&#48;owlh&#46;net">support<span>&#64;</span>owlh<span>&#46;</span>net</a></li>
<li>join OwlH slack - <a class="reference external" href="https://join.slack.com/t/owlh/shared_invite/enQtNjE2NTEwODUzNTExLTJlNTdlMDRiMzM0ZTVhNWQ0YWE4YzgyYWQ4ZGYyMDQzMzM5NDA1M2I3NDlhYTFkNjdhZTk0MzFjMGU3ZWI3ZDM">OwlH Slack workspace</a></li>
<li>ask for professional support and services - <a class="reference external" href="mailto:prohelp&#37;&#52;&#48;owlh&#46;net">prohelp<span>&#64;</span>owlh<span>&#46;</span>net</a></li>
</ul>
<div class="section" id="main-steps">
<h2>Main steps<a class="headerlink" href="#main-steps" title="Permalink to this headline">Â¶</a></h2>
<ul class="simple">
<li>Install and register your Wazuh Agent in the OwlH Node</li>
<li>Configure Wazuh Agent to read the OwlH Node output</li>
<li>Enable OwlH Node Analyzer</li>
<li>Add OwlH filebeat Module in your OwlH Manager</li>
<li>Import OwlH dashboards in your ELK Kibana</li>
</ul>
<hr class="docutils" />
<div class="section" id="install-wazuh-agent">
<h3>Install Wazuh Agent<a class="headerlink" href="#install-wazuh-agent" title="Permalink to this headline">Â¶</a></h3>
<p>Run OwlH wazuh agent script to install Wazuh-agent in your OwlH Node.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># wget repo.owlh.net/current-centos/services/owlhwazuh.sh</span>
<span class="c1"># bash owlhwazuh.sh</span>
</pre></div>
</div>
<p>Register your Wazuh Agent with your Wazuh Manager, and modify the ossec.conf file to point to it as needed. Please follow your Wazuh deployment process to run this step or refer to Wazuhâ€™s documentation.</p>
</div>
<div class="section" id="configure-wazuh-agent-to-read-owlh-output">
<h3>Configure Wazuh Agent to read OwlH output<a class="headerlink" href="#configure-wazuh-agent-to-read-owlh-output" title="Permalink to this headline">Â¶</a></h3>
<p>We need to tell our Wazuh Agent to read the OwlH Output where NIDS alerts and logs are stored. The file is created by the OwlH Analyzer and by default is /var/owlh/alerts.json. Be sure Analyzer is configured and working</p>
<p>You can configure this from User Interface:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">UI</span> <span class="o">-&gt;</span> <span class="n">nodes</span> <span class="o">-&gt;</span> <span class="n">search</span> <span class="n">your</span> <span class="n">node</span> <span class="o">-&gt;</span> <span class="n">node</span> <span class="n">services</span> <span class="n">configuration</span> <span class="o">-&gt;</span> <span class="n">Wazuh</span> <span class="o">-&gt;</span> <span class="n">add</span> <span class="n">file</span>
<span class="n">include</span> <span class="n">the</span> <span class="n">alerts</span><span class="o">.</span><span class="n">json</span> <span class="n">path</span> <span class="n">where</span> <span class="n">Analyzer</span> <span class="ow">is</span> <span class="n">storing</span> <span class="n">events</span>
<span class="n">save</span> <span class="ow">and</span> <span class="n">reload</span> <span class="n">Wazuh</span>
</pre></div>
</div>
<p>You can verify if there are new lines in the alerts.json file, UI will show current size and you can refresh it. also, you can verify ossec.log file to check if there are any errors.</p>
<p>To monitor ossec.log file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">UI</span> <span class="o">-&gt;</span> <span class="n">nodes</span> <span class="o">-&gt;</span> <span class="n">search</span> <span class="n">your</span> <span class="n">node</span> <span class="o">-&gt;</span> <span class="n">monitor</span> <span class="n">node</span> <span class="o">-&gt;</span> <span class="n">add</span> <span class="n">file</span>
<span class="n">include</span> <span class="n">your</span> <span class="n">ossec</span><span class="o">.</span><span class="n">log</span> <span class="n">file</span> <span class="o">-&gt;</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">ossec</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span><span class="n">ossec</span><span class="o">.</span><span class="n">log</span>
<span class="n">review</span> <span class="n">the</span> <span class="n">latest</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span> <span class="ow">or</span> <span class="mi">100</span> <span class="n">lines</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="wazuh-manager-and-elk-configuration">
<h3>Wazuh manager and ELK configuration<a class="headerlink" href="#wazuh-manager-and-elk-configuration" title="Permalink to this headline">Â¶</a></h3>
<p>Now you need to ensure that your Wazuh Manager is configured to manage OwlH output and is able to send to ELK properly. Also you may need to import in your ELK the default OwlH Dashboards</p>
<p>Follow the instructions here.</p>
<ul class="simple">
<li><a class="reference internal" href="OwlH-elk.html"><span class="doc">ELK integration</span></a></li>
</ul>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, owlh team.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.17.x',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>